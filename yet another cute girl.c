
#include<stdio.h>
#include<math.h>
long long int modulo(  long long int,  long long int,  long long int);
 long long int mulmod( long long int, long long int, long long int);
 long long int prime_sq[]={4,9,25,49,121,169,289,361,529,841,961,1369,1681,1849,2209,2809,3481,3721,4489,5041,5329,6241,6889,7921,9409,10201,10609,11449,11881,12769,16129,17161,18769,19321,22201,22801,24649,26569,27889,29929,32041,32761,36481,37249,38809,39601,44521,49729,51529,52441,54289,57121,58081,63001,66049,69169,72361,73441,76729,78961,80089,85849,94249,96721,97969,100489,109561,113569,120409,121801,124609,128881,134689,139129,143641,146689,151321,157609,160801,167281,175561,177241,185761,187489,192721,196249,201601,208849,212521,214369,218089,229441,237169,241081,249001,253009,259081,271441,273529,292681,299209,310249,316969,323761,326041,332929,344569,351649,358801,361201,368449,375769,380689,383161,398161,410881,413449,418609,426409,434281,436921,452929,458329,466489,477481,491401,502681,516961,528529,537289,546121,552049,564001,573049,579121,591361,597529,619369,635209,654481,657721,674041,677329,683929,687241,703921,727609,734449,737881,744769,769129,776161,779689,786769,822649,829921,844561,863041,877969,885481,896809,908209,935089,942841,954529,966289,982081,994009,1018081,1026169,1038361,1042441,1062961,1067089,1079521,1100401,1104601};
 long long int prime[]={2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997,1009,1013,1019,1021,1031,1033,1039,1049,1051,1061,1063,1069,1087,1091,1093};
int main(void)
{
    long long int i,n,t,count=0,p,k,a,b,check=0,found=0,j,l;
    for(scanf("%lld",&t);t>0;t--)
    {
        scanf("%lld %lld",&a,&b);
        for(l=a;l<=b;l++)
        {
            i=l;
            if(Miller(( long long int)i,( long long int)1))
            count++;
            else
            {
                k=( long long int)sqrt(( long long int)i);
                p=k*k;
                if(p==i)
                {
                    if(Miller(( long long int)k,( long long int)1))
                    count++;
                    else
                    {
                        for(j=0;prime[j]<=1000;j++)
                        {


                                if(i%prime[j]==0)
                                {
                                    while(i%prime_sq[j]==0)
                                    {
                                        i=(long long int)i/prime_sq[j];
                                        check=check+2;
                                        if(i==1)
                                        break;
                                    }
                                    if(i%prime[j]==0)
                                    check++;
                                    break;
                                }
                        }
                        if(i==1)
                        {
                                if(Miller((long long int)(check+1),(long long int)1))
                                count++;
                        }
                        check=0;
                    }

                }
            }

        }
        printf("%lld\n",count);
        count=0;
    }
    return 0;
}
int Miller(  long long int p,  long long int iteration)
{
      long long int i;
    if(p<2)
    {
        return 0;
    }
    if(p!=2 && p%2==0)
    {
        return 0;
    }
      long long int s=p-1;
    while(s%2==0){
        s/=2;
    }
    for(i=0;i<iteration;i++)
    {
          long long int a=rand()%(p-1)+1,temp=s;
          long long int mod=modulo(a,temp,p);
        while(temp!=p-1 && mod!=1 && mod!=p-1)
        {
            mod=mulmod(mod,mod,p);
            temp *= 2;
        }
        if(mod!=p-1 && temp%2==0)
        {
            return 0;
        }
    }
    return 1;
}
  long long int modulo(  long long int a,  long long int b,  long long int c)
 {
      long long int x=1,y=a;
    while(b > 0)
    {
        if(b%2 == 1)
        {
            x=mulmod(x,y,c);
        }
        y = mulmod(y,y,c);
        b /= 2;
    }
    return x%c;
}
 long long int mulmod( long long int a, long long int b,  long long int c)
{
         long long int x = 0,y=a%c;
        while(b > 0){
        if(b%2 == 1)
        {
            x = (x+y)%c;
        }
        y = (y*2)%c;
        b /= 2;
    }
    return x%c;
}


